var ArduinoGeo=ArduinoGeo||function(){var e=function(e){var n=" "+document.cookie,t=n.indexOf(" "+e+"=");if(-1===t)n=null;else{t=n.indexOf("=",t)+1;var o=n.indexOf(";",t);-1===o&&(o=n.length),n=unescape(n.substring(t,o))}return n}("georestriction_selection");return{get:function(){return e}}}(),ArduinoAuthHelper=ArduinoAuthHelper||function(){var n,t=!1,e={init:function(){n=jQuery.Deferred()},authURL:"https://auth.arduino.cc/",getToken:function(){return n.then(function(e){return e?e.token:null})},setToken:function(e){t=!!e,n.resolve(e)},setLoggedOut:function(){e.setToken(null)},isLoggedIn:function(){return t}};return e}(),AlgoliaHelper=AlgoliaHelper||function(){var n=void 0;return{init:function(e){n=e},getAlgoliaSearch:function(){return n}}}(),ArduinoHeaderAndFooter=ArduinoHeaderAndFooter||function(){var u="https://cdn.arduino.cc/header-footer/l6h7g1vbjb",s="https://store.arduino.cc";"usa"===ArduinoGeo.get()&&(s="https://store.arduino.cc/usa");var l=ArduinoAuthHelper.authURL;return function(t){var o=["header","footer","newsletter-modal"];t.parts&&(o=t.parts);var r="en";t.lang&&(r=t.lang);var e,n=-1!==o.indexOf("create-nav");return new Promise(function(e,n){return"undefined"==typeof jQuery?e(i("https://code.jquery.com/jquery-3.3.1.min.js")):e()}).then(function(){t.algoliaSearch&&AlgoliaHelper.init(t.algoliaSearch)}).then(function(){ArduinoAuthHelper.init()}).then(function(){jQuery.get(u+"/create-nav-images/icons.svg",function(e){var n=document.createElement("div");n.className="icons",n.style.display="none",n.innerHTML=(new XMLSerializer).serializeToString(e.documentElement),document.body.insertBefore(n,document.body.childNodes[0])});for(var e=[],n=0;n<o.length;n++)e.push(c(o[n],r));return Promise.all(e)}).then(function(){for(var e=[],n=0;n<o.length;n++)e.push(a(u+"/css/"+o[n]+".css"));return Promise.all(e)}).then(function(){for(var e=[],n=0;n<o.length;n++)e.push(i(u+"/js/"+o[n]+".js"));return"default"===t.auth&&e.push(i(u+"/login.js")),Promise.all(e)}).then(function(){return"default"===t.auth?(t.authOptions.logoutURI||(t.authOptions.logoutURI=l+"logout"),t.authUri||(t.authUri=l+"login"),f(n,new Oauth2(t.authOptions))):"custom"===t.auth?f(n,t.authOptions):(-1!==l.indexOf(window.location.hostname)&&(e="loggedout",ArduinoAuthHelper.setLoggedOut(),jQuery(".login-button").show(),jQuery(".login-button").find("a").attr("href","/login")),Promise.resolve(e))}).then(function(){return t.langSelector&&jQuery(".language-selector").show(),n?jQuery("#ino-create-nav").show():jQuery(".main-nav").show(),Promise.resolve(e)})};function i(r){return new Promise(function(e,n){var t=document.getElementsByTagName("head")[0],o=document.createElement("script");o.src=r,o.onload=o.onreadystatechange=e,o.onabort=o.onerror=n,t.appendChild(o)})}function a(r){return new Promise(function(e,n){var t=document.getElementsByTagName("head")[0],o=document.createElement("link");o.rel="stylesheet",o.href=r,o.onload=o.onreadystatechange=e,o.onabort=o.onerror=e,t.insertBefore(o,t.firstChild)})}function c(e,n){return new Promise(function(o,r){var i=u+"/"+n+"/"+e+".html";jQuery.ajaxSetup({timeout:5e4}),jQuery("#"+e).load(i,function(e,n,t){return"success"!==n?r("failure to inject "+i):o("imported "+i)})})}function f(e,t){var o,n,r,i,u,a=t.token;o=n=jQuery(".login-button");var c=jQuery(".logout");return e?(r=jQuery(".user-profile .userpic"),i=jQuery(".user-profile .default"),u=jQuery(".user-profile")):(n=jQuery(".login-button a"),r=jQuery(".profile img.user"),i=jQuery(".profile svg.default"),u=jQuery(".auth-required")),t.token().then(function(e){var n,t;return ArduinoAuthHelper.setToken(e),n=e.token,jQuery.ajax({url:"https://forum.arduino.cc/index.php?api&pm&json",headers:{Authorization:"Bearer "+n},success:function(e){0<e.data&&(jQuery(".profile .badge").html(e.data),jQuery(".profile .badge").show())},error:function(e){console.error(e)}}),t=e.token,new Promise(function(n,e){jQuery.ajax({url:l+"v1/users/byID/me?scopes=public",success:function(e){n(e)},headers:{Authorization:"Bearer "+t},error:e})})}).then(function(e){o.hide();var n=e.public.avatar;return r.attr("src",n),i.hide(),r.show(),n||(i.show(),r.hide()),r.on("error",function(){i.show(),r.hide()}),u.show(),c.on("click",function(e){if(e.preventDefault(),"function"==typeof t.logout)t.logout();else{var n=window.location.href;window.location.replace(l+"logout?redirect_uri="+n)}}),Promise.resolve(a)}).catch(function(){ArduinoAuthHelper.setLoggedOut();var e=t.redirectURI();return"function"==typeof t.login?n.on("click",function(e){e.preventDefault(),t.login()}):n.attr("href",e),o.show(),u.hide(),-1!==s.indexOf(window.location.hostname)&&jQuery(".main-nav").find(".cart-dropdown-trigger").show(),Promise.resolve(e)})}}();!function(e){function o(){}function i(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],l(e,this)}function r(t,o){for(;3===t._state;)t=t._value;return 0===t._state?void t._deferreds.push(o):(t._handled=!0,void i._immediateFn(function(){var e=1===t._state?o.onFulfilled:o.onRejected;if(null!==e){var n;try{n=e(t._value)}catch(e){return void a(o.promise,e)}u(o.promise,n)}else(1===t._state?u:a)(o.promise,t._value)}))}function u(n,e){try{if(e===n)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var t=e.then;if(e instanceof i)return n._state=3,n._value=e,void c(n);if("function"==typeof t)return void l((o=t,r=e,function(){o.apply(r,arguments)}),n)}n._state=1,n._value=e,c(n)}catch(e){a(n,e)}var o,r}function a(e,n){e._state=2,e._value=n,c(e)}function c(e){2===e._state&&0===e._deferreds.length&&i._immediateFn(function(){e._handled||i._unhandledRejectionFn(e._value)});for(var n=0,t=e._deferreds.length;n<t;n++)r(e,e._deferreds[n]);e._deferreds=null}function s(e,n,t){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof n?n:null,this.promise=t}function l(e,n){var t=!1;try{e(function(e){t||(t=!0,u(n,e))},function(e){t||(t=!0,a(n,e))})}catch(e){if(t)return;t=!0,a(n,e)}}var n=setTimeout;i.prototype.catch=function(e){return this.then(null,e)},i.prototype.then=function(e,n){var t=new this.constructor(o);return r(this,new s(e,n,t)),t},i.all=function(e){var a=Array.prototype.slice.call(e);return new i(function(o,r){function i(n,e){try{if(e&&("object"==typeof e||"function"==typeof e)){var t=e.then;if("function"==typeof t)return void t.call(e,function(e){i(n,e)},r)}a[n]=e,0==--u&&o(a)}catch(e){r(e)}}if(0===a.length)return o([]);for(var u=a.length,e=0;e<a.length;e++)i(e,a[e])})},i.resolve=function(n){return n&&"object"==typeof n&&n.constructor===i?n:new i(function(e){e(n)})},i.reject=function(t){return new i(function(e,n){n(t)})},i.race=function(r){return new i(function(e,n){for(var t=0,o=r.length;t<o;t++)r[t].then(e,n)})},i._immediateFn="function"==typeof setImmediate&&function(e){setImmediate(e)}||function(e){n(e,0)},i._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)},i._setImmediateFn=function(e){i._immediateFn=e},i._setUnhandledRejectionFn=function(e){i._unhandledRejectionFn=e},"undefined"!=typeof module&&module.exports?module.exports=i:e.Promise||(e.Promise=i)}(this);